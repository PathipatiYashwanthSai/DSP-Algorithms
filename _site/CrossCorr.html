<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/css/bootstrap.min.css" 
    rel="stylesheet" integrity="sha384-0evHe/X+R7YkIZDRvuzKMRqM+OrBnVFBL6DOitfPri4tjfHxaWutUpFmBp4vmVor" crossorigin="anonymous">
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Symbols+Sharp">
    <link rel="stylesheet" href="page.css">
    <title>Cross Correlation</title>
</head>
<body>
    <!-- <script src="https://pagecdn.io/lib/mathjs/10.5.3/math.min.js" crossorigin="anonymous"></script> -->
    <script src="https://pagecdn.io/lib/mathjs/11.0.1/math.min.js" crossorigin="anonymous"  ></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.js"></script>
    <div class="container">
    <aside>
        <div class="top">
            <h2>DSP</h2>
            <div class="close" id="close-btn">
                <span class="material-symbols-sharp">close</span>
            </div>
        </div>
        <div class="sidebar">
            <a href="index.html" class="">
                <h3>Home Page</h3>
            </a>
            <a href="CrossCorr.html" class="active">
                <h3>Cross Correlation</h3>
            </a>
            <a href="AutoCorr.html" class="">
                <h3>Auto Correlation</h3>
            </a>
            <a href="LinearConvolution.html" class="">
                <h3>Linear Convolution</h3>
            </a>
            <a href="CircularConvolution.html" class="">
                <h3>Circular Convolution</h3>
            </a>
            <a href="DFT.html" class="">
                <h3>Discrete Fourier Transform</h3>
            </a>
            <a href="IDFT.html" class="">
                <h3>Inverse Discrete Fourier Transform</h3>
            </a>
            <a href="Properties.html" class="">
                <h3>DFT & IDFT Properties</h3>
            </a>
            <a href="Linearity.html" class="">
                <h3>Linearity Property</h3>
            </a>
            <a href="LinearConvolutionUsingDFT&IDFT.html" class="">
                <h3>Linear Convolution Property</h3>
            </a>
            <a href="CircularConvolutionUsingDFT&IDFT.html" class="">
                <h3>Circular Convolution Property</h3>
            </a>
            <a href="CircularTimeShift.html" class="">
                <h3>Circular Timeshift Property</h3>
            </a>
            <a href="Modulation.html" class="">
                <h3>Modulation Property</h3>
            </a>
        </div>
    </aside>
    <div class="flex-container">
        <main>
            <h2 style="text-align: center;"> Cross Correlation</h2><br>
            <p>In signal processing, cross-correlation is a measure of similarity of two series as a function of the displacement of one relative to the other. This is also known as a sliding dot product or sliding inner-product. It is commonly used for searching a long signal for a shorter, known feature. It has applications in pattern recognition, single particle analysis, electron tomography, averaging, cryptanalysis, and neurophysiology. The cross-correlation is similar in nature to the convolution of two functions.</p>
            <h4><strong>Explanation:</strong></h4>
            <p>Consider two finite length sequences, say x(n) and y(n). The cross correlation of x(n) and y(n) can be obtained by simply performing convolution between x(n) and y(-n) i.e</p>
            <h5 style="text-align: center;">R<sub>xy</sub>(n) = x(n)*y(-n)</h5><br><br>
            <p>The step-by-step values for the provided input is shown below :</p>
            <h4 class="plot-title" id="exp-part-1">x(n) and y(n) :</h4>
            <table id="exp">
            </table><hr>
            <h4 class="plot-title" id="exp-part-2">Add the below sequences :</h4>
            <table id="exp1">
            </table><hr>
            <h4 class="plot-title" id="exp-part-3">R<sub>xy</sub>(n) :</h4>
            <table id="exp2">
            </table><br><br>
        </main>
        <div class="right">
            <div class="top">
                <button id="menu-btn">
                    <span class="material-symbols-sharp">menu</span>
                </button>
                <div class="theme-toggler">
                    <span class="material-symbols-sharp active">light_mode</span>
                    <span class="material-symbols-sharp">dark_mode</span>
                </div>
            </div>
            <div class="interface-section">
                <br>
                <h3>Enter the first sequence :</h3>
                <input id="sequence1" placeholder="1,2,3,4..."/>
                <br><br>
                <h3>Enter the second sequence :</h3>
                <input id="sequence2" placeholder="1,2,3,4..."/>
                <br><br>
                <button type="submit" class="btn btn-warning" onclick="crossCorr()">Submit</button>
                <br><br>
                <h4 id="crossCorrResponse"></h4>
                <br><br>
                <h4 class="plot-title" id="input-title">x(n) :</h4><br>
                <!-- Input sequence plot is displayed -->
                <canvas class="outputSequence" id="inputResp"></canvas>
                <br><br>
                <h4 class="plot-title" id="impulse-title">y(n) :</h4><br>
                <!-- Impulse sequence plot is displayed -->
                <canvas class="outputSequence" id="impulseResp"></canvas>
                <br><br>
                <h4 class="plot-title" id="output-title">R<sub>xy</sub>(n) :</h4><br>
                <!-- Output sequence plot is displayed -->
                <canvas class="outputSequence" id="outputResp"></canvas><br><br>
            </div>
        </div>
    </div>
</div>

<script type="text/javascript">
    function crossCorr() {
        // The explanatory tables are initiated with null
        document.getElementById("exp").innerHTML="";
        document.getElementById("exp1").innerHTML="";
        document.getElementById("exp2").innerHTML="";
        // Input sequences are taken
        const x = document.getElementById("sequence1").value.split(",");
        const y = document.getElementById("sequence2").value.split(",").reverse();
        const m = x.length;
        const n = y.length;
        // N is the length to which correlation is performed
        const N = m+n-1;
        // Values are iterated and converted to float
        const xt = x.map((val) => parseFloat(val));
        const yt = y.map((val) => parseFloat(val));
        const ytReversed = y.map((val) => parseFloat(val)).reverse();

        // Input sequences are displayed for dynamic part
        if(m<n) {
            var tr = document.createElement('tr');
            var str ='';
            for(let i=0;i<n-m;i++){
                str+=`<td></td>`;
                tr.innerHTML=str;
            }
            for(let i=0;i<m;i++) {
                str+=`<td> ${xt[i]}</td>`;
                tr.innerHTML=str;
            }
            document.getElementById("exp").appendChild(tr);
            var tr = document.createElement('tr');
            var str ='';
            for(let i=0;i<n;i++) {
                str+=`<td> ${yt[i]}</td>`;
                tr.innerHTML=str;
            }
            document.getElementById("exp").appendChild(tr);
        } else if(n<m) {
            var tr = document.createElement('tr');
            var str ='';
            for(let i=0;i<m;i++) {
                str+=`<td> ${xt[i]}</td>`;
                tr.innerHTML=str;
            }
            document.getElementById("exp").appendChild(tr);
            var tr = document.createElement('tr');
            var str ='';
            for(let i=0;i<m-n;i++){
                str+=`<td></td>`;
                tr.innerHTML=str;
            }
            for(let i=0;i<n;i++) {
                str+=`<td> ${yt[i]}</td>`;
                tr.innerHTML=str;
            }
            document.getElementById("exp").appendChild(tr);
        } else {
            var tr = document.createElement('tr');
            var str ='';
            for(let i=0;i<m;i++) {
                str+=`<td> ${xt[i]}</td>`;
                tr.innerHTML=str;
            }
            document.getElementById("exp").appendChild(tr);
            var tr = document.createElement('tr');
            var str ='';
            for(let i=0;i<n;i++) {
                str+=`<td> ${yt[i]}</td>`;
                tr.innerHTML=str;
            }
            document.getElementById("exp").appendChild(tr);
        }
        // step-by-step of convolution is displayed
        for(let i=0;i<n;i++) {
            var tr = document.createElement('tr');
            var str ='';
            for(let k=0;k<i;k++) {
                str+=`<td></td>`;
                tr.innerHTML=str;
            }
            for(let j=0;j<m;j++){
                str+=`<td> ${yt[i]*xt[j]}</td>`;
                tr.innerHTML=str;
            }
            document.getElementById("exp1").appendChild(tr);
        }

        for(let a=0; a<N-m; a++) {
            xt.push(0);
        }
        for(let b=0; b<N-n; b++) {
            yt.push(0);
        }
        const Rxy = [];
        for(let i=0; i<N; i++){
            sum = 0;
            for(let j=0; j<N; j++){
                if(j <=i) {
                    sum += xt[j]*yt[i-j];
                } else {
                    sum += xt[j]*yt[N+i-j];
                }
            }
            Rxy.push(sum);
        }
        // output response is displayed
        document.getElementById("crossCorrResponse").innerText = "The Cross Correlation output is: \n" + Rxy;
        
        
        var tr = document.createElement('tr');
        var str ='';
        for(let i=0;i<N;i++) {
            str+=`<th> ${Rxy[i]}</th>`;
            tr.innerHTML=str;
        }
        document.getElementById("exp2").appendChild(tr);

        // input sequence will be plotted
        const xyInputValues = [];
        for(let j=0; j<m; j++) {
            xyInputValues.push({x:j,y:xt[j]});
        }
        new Chart("inputResp", {
            type: "scatter",
            data: {
                datasets: [{
                    pointRadius: 4,
                    pointBackgroundColor: "rgb(0,0,255)",
                    data: xyInputValues
                }]
            },
            options: {
                legend: {display: false}
            }
        });

        // impulse sequence will be plotted
        const xyImpulseValues = [];
        for(let j=0; j<n; j++) {
            xyImpulseValues.push({x:j,y:ytReversed[j]});
        }
        new Chart("impulseResp", {
            type: "scatter",
            data: {
                datasets: [{
                    pointRadius: 4,
                    pointBackgroundColor: "rgb(0,0,255)",
                    data: xyImpulseValues
                }]
            },
            options: {
                legend: {display: false}
            }
        });

        // output sequence will be plotted
        const xyOutputValues = [];
        for(let j=0; j<N; j++) {
            xyOutputValues.push({x:j,y:Rxy[j]});
        }
        new Chart("outputResp", {
            type: "scatter",
            data: {
                datasets: [{
                    pointRadius: 4,
                    pointBackgroundColor: "rgb(0,0,255)",
                    data: xyOutputValues
                }]
            },
            options: {
                legend: {display: false}
            }
        });

        // specific texts are displayed
        document.getElementById("inputResp").style.display ="block";
        document.getElementById("input-title").style.display ="block";
        document.getElementById("impulseResp").style.display ="block";
        document.getElementById("impulse-title").style.display ="block";
        document.getElementById("outputResp").style.display ="block";
        document.getElementById("output-title").style.display ="block";
        document.getElementById("exp-part-1").style.display ="block";
        document.getElementById("exp-part-2").style.display ="block";
        document.getElementById("exp-part-3").style.display ="block";
    }
</script>

    <script src="responsive.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/js/bootstrap.bundle.min.js" 
    integrity="sha384-pprn3073KE6tl6bjs2QrFaJGz5/SUsLqktiwsUTF55Jfv3qYSDhgCecCxMW52nD2" crossorigin="anonymous"></script>
</body>
</html>